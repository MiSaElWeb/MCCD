/*
* MIXITUP - A CSS3 and JQuery Filter & Sort Plugin
* Version: 1.5.4
* License: Creative Commons Attribution-NoDerivs 3.0 Unported - CC BY-ND 3.0
* http://creativecommons.org/licenses/by-nd/3.0/
* This software may be used freely on commercial and non-commercial projects with attribution to the author/copyright holder.
* Author: Patrick Kunka
* Copyright 2012-2013 Patrick Kunka, Barrel LLC, All Rights Reserved
* 
* http://mixitup.io
*/(function(e){function n(t,n,i,u,a){function k(){v.unbind("webkitTransitionEnd transitionend otransitionend oTransitionEnd");n&&r(n,i,u,a);a.startOrder=[],a.newOrder=[],a.origSort=[],a.checkSort=[];d.removeStyle(a.prefix+"filter, filter, "+a.prefix+"transform, transform, opacity, display").css(a.clean).removeAttr("data-checksum");window.atob||d.css({display:"none",opacity:"0"});var e=a.resizeContainer?"height":"";v.removeStyle(a.prefix+"transition, transition, "+a.prefix+"perspective, perspective, "+a.prefix+"perspective-origin, perspective-origin, "+e);if(a.layoutMode=="list"){g.css({display:a.targetDisplayList,opacity:"1"});a.origDisplay=a.targetDisplayList}else{g.css({display:a.targetDisplayGrid,opacity:"1"});a.origDisplay=a.targetDisplayGrid}a.origLayout=a.layoutMode;var t=setTimeout(function(){d.removeStyle(a.prefix+"transition, transition");a.mixing=!1;if(typeof a.onMixEnd=="function"){var e=a.onMixEnd.call(this,a);a=e?e:a}})}clearInterval(a.failsafe);a.mixing=!0;a.filter=t;if(typeof a.onMixStart=="function"){var f=a.onMixStart.call(this,a);a=f?f:a}var l=a.transitionSpeed;for(var c=0;c<2;c++){var h=c==0?h=a.prefix:"";a.transition[h+"transition"]="all "+l+"ms linear";a.transition[h+"transform"]=h+"translate3d(0,0,0)";a.perspective[h+"perspective"]=a.perspectiveDistance+"px";a.perspective[h+"perspective-origin"]=a.perspectiveOrigin}var p=a.targetSelector,d=u.find(p);d.each(function(){this.data={}});var v=d.parent();v.css(a.perspective);a.easingFallback="ease-in-out";a.easing=="smooth"&&(a.easing="cubic-bezier(0.25, 0.46, 0.45, 0.94)");a.easing=="snap"&&(a.easing="cubic-bezier(0.77, 0, 0.175, 1)");a.easing=="windback"&&(a.easing="cubic-bezier(0.175, 0.885, 0.320, 1.275)",a.easingFallback="cubic-bezier(0.175, 0.885, 0.320, 1)");a.easing=="windup"&&(a.easing="cubic-bezier(0.6, -0.28, 0.735, 0.045)",a.easingFallback="cubic-bezier(0.6, 0.28, 0.735, 0.045)");var m=a.layoutMode=="list"&&a.listEffects!=null?a.listEffects:a.effects;if(Array.prototype.indexOf){a.fade=m.indexOf("fade")>-1?"0":"";a.scale=m.indexOf("scale")>-1?"scale(.01)":"";a.rotateZ=m.indexOf("rotateZ")>-1?"rotate(180deg)":"";a.rotateY=m.indexOf("rotateY")>-1?"rotateY(90deg)":"";a.rotateX=m.indexOf("rotateX")>-1?"rotateX(90deg)":"";a.blur=m.indexOf("blur")>-1?"blur(8px)":"";a.grayscale=m.indexOf("grayscale")>-1?"grayscale(100%)":""}var g=e(),y=e(),b=[],w=!1;if(typeof t=="string")b=o(t);else{w=!0;e.each(t,function(e){b[e]=o(this)})}if(a.filterLogic=="or"){b[0]==""&&b.shift();b.length<1?y=y.add(u.find(p+":visible")):d.each(function(){var t=e(this);if(!w)t.is("."+b.join(", ."))?g=g.add(t):y=y.add(t);else{var n=0;e.each(b,function(e){this.length?t.is("."+this.join(", ."))&&n++:n>0&&n++});n==b.length?g=g.add(t):y=y.add(t)}})}else{g=g.add(v.find(p+"."+b.join(".")));y=y.add(v.find(p+":not(."+b.join(".")+"):visible"))}var E=g.length,S=e(),x=e(),T=e();y.each(function(){var t=e(this);if(t.css("display")!="none"){S=S.add(t);T=T.add(t)}});if(g.filter(":visible").length==E&&!S.length&&!n){if(a.origLayout==a.layoutMode){k();return!1}if(g.length==1){if(a.layoutMode=="list"){u.addClass(a.listClass);u.removeClass(a.gridClass);T.css("display",a.targetDisplayList)}else{u.addClass(a.gridClass);u.removeClass(a.listClass);T.css("display",a.targetDisplayGrid)}k();return!1}}a.origHeight=v.height();if(g.length){u.removeClass(a.failClass);g.each(function(){var t=e(this);t.css("display")=="none"?x=x.add(t):T=T.add(t)});if(a.origLayout!=a.layoutMode&&a.animateGridList==0){if(a.layoutMode=="list"){u.addClass(a.listClass);u.removeClass(a.gridClass);T.css("display",a.targetDisplayList)}else{u.addClass(a.gridClass);u.removeClass(a.listClass);T.css("display",a.targetDisplayGrid)}k();return!1}if(!window.atob){k();return!1}d.css(a.clean);T.each(function(){this.data.origPos=e(this).offset()});if(a.layoutMode=="list"){u.addClass(a.listClass);u.removeClass(a.gridClass);x.css("display",a.targetDisplayList)}else{u.addClass(a.gridClass);u.removeClass(a.listClass);x.css("display",a.targetDisplayGrid)}x.each(function(){this.data.showInterPos=e(this).offset()});S.each(function(){this.data.hideInterPos=e(this).offset()});T.each(function(){this.data.preInterPos=e(this).offset()});a.layoutMode=="list"?T.css("display",a.targetDisplayList):T.css("display",a.targetDisplayGrid);n&&r(n,i,u,a);if(n&&s(a.origSort,a.checkSort)){k();return!1}S.hide();x.each(function(t){this.data.finalPos=e(this).offset()});T.each(function(){this.data.finalPrePos=e(this).offset()});a.newHeight=v.height();n&&r("reset",null,u,a);x.hide();T.css("display",a.origDisplay);if(a.origDisplay=="block"){u.addClass(a.listClass);x.css("display",a.targetDisplayList)}else{u.removeClass(a.listClass);x.css("display",a.targetDisplayGrid)}a.resizeContainer&&v.css("height",a.origHeight+"px");var N={};for(var c=0;c<2;c++){var h=c==0?h=a.prefix:"";N[h+"transform"]=a.scale+" "+a.rotateX+" "+a.rotateY+" "+a.rotateZ;N[h+"filter"]=a.blur+" "+a.grayscale}x.css(N);T.each(function(){var t=this.data,n=e(this);if(n.hasClass("mix_tohide")){t.preTX=t.origPos.left-t.hideInterPos.left;t.preTY=t.origPos.top-t.hideInterPos.top}else{t.preTX=t.origPos.left-t.preInterPos.left;t.preTY=t.origPos.top-t.preInterPos.top}var r={};for(var i=0;i<2;i++){var s=i==0?s=a.prefix:"";r[s+"transform"]="translate("+t.preTX+"px,"+t.preTY+"px)"}n.css(r)});if(a.layoutMode=="list"){u.addClass(a.listClass);u.removeClass(a.gridClass)}else{u.addClass(a.gridClass);u.removeClass(a.listClass)}var C=setTimeout(function(){if(a.resizeContainer){var t={};for(var n=0;n<2;n++){var r=n==0?r=a.prefix:"";t[r+"transition"]="all "+l+"ms ease-in-out";t.height=a.newHeight+"px"}v.css(t)}S.css("opacity",a.fade);x.css("opacity",1);x.each(function(){var t=this.data;t.tX=t.finalPos.left-t.showInterPos.left;t.tY=t.finalPos.top-t.showInterPos.top;var n={};for(var r=0;r<2;r++){var i=r==0?i=a.prefix:"";n[i+"transition-property"]=i+"transform, "+i+"filter, opacity";n[i+"transition-timing-function"]=a.easing+", linear, linear";n[i+"transition-duration"]=l+"ms";n[i+"transition-delay"]="0";n[i+"transform"]="translate("+t.tX+"px,"+t.tY+"px)";n[i+"filter"]="none"}e(this).css("-webkit-transition","all "+l+"ms "+a.easingFallback).css(n)});T.each(function(){var t=this.data;t.tX=t.finalPrePos.left!=0?t.finalPrePos.left-t.preInterPos.left:0;t.tY=t.finalPrePos.left!=0?t.finalPrePos.top-t.preInterPos.top:0;var n={};for(var r=0;r<2;r++){var i=r==0?i=a.prefix:"";n[i+"transition"]="all "+l+"ms "+a.easing;n[i+"transform"]="translate("+t.tX+"px,"+t.tY+"px)"}e(this).css("-webkit-transition","all "+l+"ms "+a.easingFallback).css(n)});var i={};for(var n=0;n<2;n++){var r=n==0?r=a.prefix:"";i[r+"transition"]="all "+l+"ms "+a.easing+", "+r+"filter "+l+"ms linear, opacity "+l+"ms linear";i[r+"transform"]=a.scale+" "+a.rotateX+" "+a.rotateY+" "+a.rotateZ;i[r+"filter"]=a.blur+" "+a.grayscale;i.opacity=a.fade}S.css(i);v.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(t){if(t.originalEvent.propertyName.indexOf("transform")>-1||t.originalEvent.propertyName.indexOf("opacity")>-1)p.indexOf(".")>-1?e(t.target).hasClass(p.replace(".",""))&&k():e(t.target).is(p)&&k()})},10);a.failsafe=setTimeout(function(){a.mixing&&k()},l+400)}else{a.resizeContainer&&v.css("height",a.origHeight+"px");if(!window.atob){k();return!1}S=y;var C=setTimeout(function(){v.css(a.perspective);if(a.resizeContainer){var e={};for(var t=0;t<2;t++){var n=t==0?n=a.prefix:"";e[n+"transition"]="height "+l+"ms ease-in-out";e.height=a.minHeight+"px"}v.css(e)}d.css(a.transition);var r=y.length;if(r){var i={};for(var t=0;t<2;t++){var n=t==0?n=a.prefix:"";i[n+"transform"]=a.scale+" "+a.rotateX+" "+a.rotateY+" "+a.rotateZ;i[n+"filter"]=a.blur+" "+a.grayscale;i.opacity=a.fade}S.css(i);v.bind("webkitTransitionEnd transitionend otransitionend oTransitionEnd",function(e){if(e.originalEvent.propertyName.indexOf("transform")>-1||e.originalEvent.propertyName.indexOf("opacity")>-1){u.addClass(a.failClass);k()}})}else a.mixing=!1},10)}}function r(t,n,r,i){function s(e,n){var r=isNaN(e.attr(t)*1)?e.attr(t).toLowerCase():e.attr(t)*1,i=isNaN(n.attr(t)*1)?n.attr(t).toLowerCase():n.attr(t)*1;return r<i?-1:r>i?1:0}function o(e){n=="asc"?a.prepend(e).prepend(" "):a.append(e).append(" ")}function u(e){var t=e.slice(),n=t.length,r=n;while(r--){var i=parseInt(Math.random()*n),s=t[r];t[r]=t[i];t[i]=s}return t}r.find(i.targetSelector).wrapAll('<div class="mix_sorter"/>');var a=r.find(".mix_sorter");i.origSort.length||a.find(i.targetSelector+":visible").each(function(){e(this).wrap("<s/>");i.origSort.push(e(this).parent().html().replace(/\s+/g,""));e(this).unwrap()});a.empty();if(t=="reset")e.each(i.startOrder,function(){a.append(this).append(" ")});else if(t=="default")e.each(i.origOrder,function(){o(this)});else if(t=="random"){i.newOrder.length||(i.newOrder=u(i.startOrder));e.each(i.newOrder,function(){a.append(this).append(" ")})}else if(t=="custom")e.each(n,function(){o(this)});else{if(typeof i.origOrder[0].attr(t)=="undefined"){console.log("No such attribute found. Terminating");return!1}if(!i.newOrder.length){e.each(i.origOrder,function(){i.newOrder.push(e(this))});i.newOrder.sort(s)}e.each(i.newOrder,function(){o(this)})}i.checkSort=[];a.find(i.targetSelector+":visible").each(function(t){var n=e(this);t==0&&n.attr("data-checksum","1");n.wrap("<s/>");i.checkSort.push(n.parent().html().replace(/\s+/g,""));n.unwrap()});r.find(i.targetSelector).unwrap()}function i(e){var t=["Webkit","Moz","O","ms"];for(var n=0;n<t.length;n++)if(t[n]+"Transition"in e.style)return t[n];return"transition"in e.style?"":!1}function s(e,t){if(e.length!=t.length)return!1;for(var n=0;n<t.length;n++){if(e[n].compare&&!e[n].compare(t[n]))return!1;if(e[n]!==t[n])return!1}return!0}function o(t){t=t.replace(/\s{2,}/g," ");var n=t.split(" ");e.each(n,function(e){this=="all"&&(n[e]="mix_all")});n[0]==""&&n.shift();return n}var t={init:function(t){return this.each(function(){var s={targetSelector:".mix",filterSelector:".filter",sortSelector:".sort",buttonEvent:"click",effects:["blur","rotateX"],listEffects:null,easing:"ease-in-out",layoutMode:"grid",targetDisplayGrid:"inline-block",targetDisplayList:"block",listClass:"",gridClass:"og-grid",transitionSpeed:400,showOnLoad:"all",sortOnLoad:!1,multiFilter:!1,filterLogic:"or",resizeContainer:!1,minHeight:0,failClass:"fail",perspectiveDistance:"3000",perspectiveOrigin:"50% 50%",animateGridList:!0,onMixLoad:null,onMixStart:null,onMixEnd:null,container:null,origOrder:[],startOrder:[],newOrder:[],origSort:[],checkSort:[],filter:"",mixing:!1,origDisplay:"",origLayout:"",origHeight:0,newHeight:0,isTouch:!1,resetDelay:0,failsafe:null,prefix:"",easingFallback:"ease-in-out",transition:{},perspective:{},clean:{},fade:"1",scale:"",rotateX:"",rotateY:"",rotateZ:"",blur:"",grayscale:""};t&&e.extend(s,t);this.config=s;e.support.touch="ontouchend"in document;if(e.support.touch){s.isTouch=!0;s.resetDelay=350}s.container=e(this);var o=s.container;s.prefix=i(o[0]);s.prefix=s.prefix?"-"+s.prefix.toLowerCase()+"-":"";o.find(s.targetSelector).each(function(){s.origOrder.push(e(this))});if(s.sortOnLoad){var u,a;if(e.isArray(s.sortOnLoad)){u=s.sortOnLoad[0],a=s.sortOnLoad[1];e(s.sortSelector+"[data-sort="+s.sortOnLoad[0]+"][data-order="+s.sortOnLoad[1]+"]").addClass("activefilter")}else{e(s.sortSelector+"[data-sort="+s.sortOnLoad+"]").addClass("activefilter");u=s.sortOnLoad,s.sortOnLoad="desc"}r(u,a,o,s)}for(var f=0;f<2;f++){var l=f===0?l=s.prefix:"";s.transition[l+"transition"]="all "+s.transitionSpeed+"ms ease-in-out";s.perspective[l+"perspective"]=s.perspectiveDistance+"px";s.perspective[l+"perspective-origin"]=s.perspectiveOrigin}for(var f=0;f<2;f++){var l=f===0?l=s.prefix:"";s.clean[l+"transition"]="none"}if(s.layoutMode=="list"){o.addClass(s.listClass);s.origDisplay=s.targetDisplayList}else{o.addClass(s.gridClass);s.origDisplay=s.targetDisplayGrid}s.origLayout=s.layoutMode;var c=s.showOnLoad.split(" ");e.each(c,function(){e(s.filterSelector+'[data-filter="'+this+'"]').addClass("activefilter")});o.find(s.targetSelector).addClass("mix_all");c[0]=="all"&&(c[0]="mix_all",s.showOnLoad="mix_all");var h=e();e.each(c,function(){h=h.add(e("."+this))});h.each(function(){var t=e(this);s.layoutMode=="list"?t.css("display",s.targetDisplayList):t.css("display",s.targetDisplayGrid);t.css(s.transition)});var p=setTimeout(function(){s.mixing=!0;h.css("opacity","1");var e=setTimeout(function(){s.layoutMode=="list"?h.removeStyle(s.prefix+"transition, transition").css({display:s.targetDisplayList,opacity:1}):h.removeStyle(s.prefix+"transition, transition").css({display:s.targetDisplayGrid,opacity:1});s.mixing=!1;if(typeof s.onMixLoad=="function"){var e=s.onMixLoad.call(this,s);s=e?e:s}},s.transitionSpeed)},10);s.filter=s.showOnLoad;e(s.sortSelector).bind(s.buttonEvent,function(){if(!s.mixing){var t=e(this),r=t.attr("data-sort"),i=t.attr("data-order");if(!t.hasClass("activefilter")){e(s.sortSelector).removeClass("activefilter");t.addClass("activefilter")}else if(r!="random")return!1;o.find(s.targetSelector).each(function(){s.startOrder.push(e(this))});n(s.filter,r,i,o,s)}});e(s.filterSelector).bind(s.buttonEvent,function(){if(!s.mixing){var t=e(this);if(s.multiFilter==0){e(s.filterSelector).removeClass("activefilter");t.addClass("activefilter");s.filter=t.attr("data-filter");e(s.filterSelector+'[data-filter="'+s.filter+'"]').addClass("activefilter")}else{var r=t.attr("data-filter");if(t.hasClass("activefilter")){t.removeClass("activefilter");var i=new RegExp("(\\s|^)"+r);s.filter=s.filter.replace(i,"")}else{t.addClass("activefilter");s.filter=s.filter+" "+r}}n(s.filter,null,null,o,s)}})})},toGrid:function(){return this.each(function(){var t=this.config;if(t.layoutMode!="grid"){t.layoutMode="grid";n(t.filter,null,null,e(this),t)}})},toList:function(){return this.each(function(){var t=this.config;if(t.layoutMode!="list"){t.layoutMode="list";n(t.filter,null,null,e(this),t)}})},filter:function(t){return this.each(function(){var r=this.config;if(!r.mixing){e(r.filterSelector).removeClass("activefilter");e(r.filterSelector+'[data-filter="'+t+'"]').addClass("activefilter");n(t,null,null,e(this),r)}})},sort:function(t){return this.each(function(){var r=this.config,i=e(this);if(!r.mixing){e(r.sortSelector).removeClass("activefilter");if(e.isArray(t)){var s=t[0],o=t[1];e(r.sortSelector+'[data-sort="'+t[0]+'"][data-order="'+t[1]+'"]').addClass("activefilter")}else{e(r.sortSelector+'[data-sort="'+t+'"]').addClass("activefilter");var s=t,o="desc"}i.find(r.targetSelector).each(function(){r.startOrder.push(e(this))});n(r.filter,s,o,i,r)}})},multimix:function(t){return this.each(function(){var r=this.config,i=e(this);multiOut={filter:r.filter,sort:null,order:"desc",layoutMode:r.layoutMode};e.extend(multiOut,t);if(!r.mixing){e(r.filterSelector).add(r.sortSelector).removeClass("activefilter");e(r.filterSelector+'[data-filter="'+multiOut.filter+'"]').addClass("activefilter");if(typeof multiOut.sort!="undefined"){e(r.sortSelector+'[data-sort="'+multiOut.sort+'"][data-order="'+multiOut.order+'"]').addClass("activefilter");i.find(r.targetSelector).each(function(){r.startOrder.push(e(this))})}r.layoutMode=multiOut.layoutMode;n(multiOut.filter,multiOut.sort,multiOut.order,i,r)}})},remix:function(t){return this.each(function(){var r=this.config,i=e(this);r.origOrder=[];i.find(r.targetSelector).each(function(){var t=e(this);t.addClass("mix_all");r.origOrder.push(t)});if(!r.mixing&&typeof t!="undefined"){e(r.filterSelector).removeClass("activefilter");e(r.filterSelector+'[data-filter="'+t+'"]').addClass("activefilter");n(t,null,null,i,r)}})}};e.fn.mixitup=function(e,n){if(t[e])return t[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return t.init.apply(this,arguments)};e.fn.removeStyle=function(t){return this.each(function(){var n=e(this);t=t.replace(/\s+/g,"");var r=t.split(",");e.each(r,function(){var e=new RegExp(this.toString()+"[^;]+;?","g");n.attr("style",function(t,n){if(n)return n.replace(e,"")})})})}})(jQuery);